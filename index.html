<!DOCTYPE html>
<meta charset="utf-8">
<style>
.axis text {
  font: 10px sans-serif;
}
.axis line,
.axis path {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}
</style>
<script src="bower_components/d3/d3.js"></script>
<script src="d3-drawing.js"></script>
<body>
<script>
(function () {
  // Coerce population counts to numbers and compute total per state.
  var groups = [
    "Under 5 Years",
    "5 to 13 Years",
    "14 to 17 Years",
    "18 to 24 Years",
    "25 to 44 Years",
    "45 to 64 Years",
    "65 Years and Over"
  ];

  function type(d) {
    d.total = d3.sum(groups, function(k) { return d[k] = +d[k]; });
    return d;
  }

  d3.csv('data.csv', type, function(error, states) {
    if (error) throw error;
    console.log(states);
    var stateById = d3.map();
    states.forEach(function(d) { stateById.set(d.id, d); });
    dispatch.load(stateById, groups);
    dispatch.statechange(stateById.get("CA"));
  });
}());
</script>
</body>
